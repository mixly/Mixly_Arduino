/*! For license information please see index.js.LICENSE.txt */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("blockly/core"),require("blockly/javascript"),require("blockly/dart"),require("blockly/lua"),require("blockly/php"),require("blockly/python"));else if("function"==typeof define&&define.amd)define(["blockly/core","blockly/javascript","blockly/dart","blockly/lua","blockly/php","blockly/python"],e);else{var r="object"==typeof exports?e(require("blockly/core"),require("blockly/javascript"),require("blockly/dart"),require("blockly/lua"),require("blockly/php"),require("blockly/python")):e(t.Blockly,t["Blockly.JavaScript"],t["Blockly.Dart"],t["Blockly.Lua"],t["Blockly.PHP"],t["Blockly.Python"]);for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(this,((t,e,r,n,o,i)=>(()=>{var s={348:function(t,e,r){var n;n=(t,e,r,n,o,i)=>(()=>{"use strict";var s={370:e=>{e.exports=t},379:t=>{t.exports=r},127:t=>{t.exports=e},157:t=>{t.exports=n},537:t=>{t.exports=o},557:t=>{t.exports=i}},l={};function a(t){var e=l[t];if(void 0!==e)return e.exports;var r=l[t]={exports:{}};return s[t](r,r.exports,a),r.exports}a.d=(t,e)=>{for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var d={};return(()=>{a.r(d),a.d(d,{FieldColour:()=>i,colourBlend:()=>n,colourPicker:()=>t,colourRandom:()=>e,colourRgb:()=>r,installAllBlocks:()=>tt,registerFieldColour:()=>s});var t={};a.r(t),a.d(t,{BLOCK_NAME:()=>g,blockDefinition:()=>C,installBlock:()=>x,toDart:()=>_,toJavascript:()=>f,toLua:()=>E,toPhp:()=>O,toPython:()=>m});var e={};a.r(e),a.d(e,{BLOCK_NAME:()=>S,blockDefinition:()=>B,installBlock:()=>$,toDart:()=>T,toJavascript:()=>L,toLua:()=>N,toPhp:()=>k,toPython:()=>I});var r={};a.r(r),a.d(r,{BLOCK_NAME:()=>U,blockDefinition:()=>G,installBlock:()=>K,toDart:()=>M,toJavascript:()=>D,toLua:()=>H,toPhp:()=>w,toPython:()=>F});var n={};a.r(n),a.d(n,{BLOCK_NAME:()=>j,blockDefinition:()=>J,installBlock:()=>Z,toDart:()=>W,toJavascript:()=>Y,toLua:()=>X,toPhp:()=>q,toPython:()=>z});var o=a(370);class i extends o.Field{constructor(t,e,r){super(o.Field.SKIP_SETUP),this.picker=null,this.highlightedIndex=null,this.boundEvents=[],this.SERIALIZABLE=!0,this.CURSOR="default",this.isDirty_=!1,this.colours=["#ffffff","#cccccc","#c0c0c0","#999999","#666666","#333333","#000000","#ffcccc","#ff6666","#ff0000","#cc0000","#990000","#660000","#330000","#ffcc99","#ff9966","#ff9900","#ff6600","#cc6600","#993300","#663300","#ffff99","#ffff66","#ffcc66","#ffcc33","#cc9933","#996633","#663333","#ffffcc","#ffff33","#ffff00","#ffcc00","#999900","#666600","#333300","#99ff99","#66ff99","#33ff33","#33cc00","#009900","#006600","#003300","#99ffff","#33ffff","#66cccc","#00cccc","#339999","#336666","#003333","#ccffff","#66ffff","#33ccff","#3366ff","#3333ff","#000099","#000066","#ccccff","#9999ff","#6666cc","#6633ff","#6600cc","#333399","#330099","#ffccff","#ff99ff","#cc66cc","#cc33cc","#993399","#663366","#330033"],this.titles=[],this.columns=7,t!==o.Field.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(t),e&&this.setValidator(e))}configure_(t){super.configure_(t),t.colourOptions&&(this.colours=t.colourOptions),t.colourTitles&&(this.titles=t.colourTitles),t.columns&&(this.columns=t.columns)}initView(){const t=this.getConstants();if(!t)throw Error("Constants not found");this.size_=new o.utils.Size(t.FIELD_COLOUR_DEFAULT_WIDTH,t.FIELD_COLOUR_DEFAULT_HEIGHT),this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1",this.getBorderRect().setAttribute("stroke","#fff"),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){if(!this.getSourceBlock())throw new o.UnattachedFieldError;const t=this.getConstants();return this.blockIsSimpleReporter()&&Boolean(null==t?void 0:t.FIELD_COLOUR_FULL_BLOCK)}blockIsSimpleReporter(){const t=this.getSourceBlock();if(!t)throw new o.UnattachedFieldError;if(!t.outputConnection)return!1;for(const e of t.inputList)if(e.connection||e.fieldRow.length>1)return!1;return!0}applyColour(){const t=this.getSourceBlock();if(!t)throw new o.UnattachedFieldError;if(!this.fieldGroup_)return;const e=this.borderRect_;if(!e)throw new Error("The border rect has not been initialized");this.isFullBlockField()?(e.style.display="none",t.pathObject.svgPath.setAttribute("fill",this.getValue()),t.pathObject.svgPath.setAttribute("stroke","#fff")):(e.style.display="block",e.style.fill=this.getValue())}getSize(){var t;return(null===(t=this.getConstants())||void 0===t?void 0:t.FIELD_COLOUR_FULL_BLOCK)&&(this.render_(),this.isDirty_=!1),super.getSize()}render_(){super.render_();const t=this.getSourceBlock();if(!t)throw new o.UnattachedFieldError;t.applyColour()}updateSize_(t){const e=this.getConstants();if(!e)return;let r,n;this.isFullBlockField()?(r=2*(null!=t?t:0),n=e.FIELD_TEXT_HEIGHT):(r=e.FIELD_COLOUR_DEFAULT_WIDTH,n=e.FIELD_COLOUR_DEFAULT_HEIGHT),this.size_.height=n,this.size_.width=r,this.positionBorderRect_()}doClassValidation_(t){return"string"!=typeof t?null:o.utils.colour.parse(t)}getText(){let t=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(t)&&(t="#"+t[1]+t[3]+t[5]),t}setColours(t,e){return this.colours=t,e&&(this.titles=e),this}setColumns(t){return this.columns=t,this}showEditor_(){if(this.dropdownCreate(),!this.picker)throw Error("Picker not found");o.DropDownDiv.getContentDiv().appendChild(this.picker),o.DropDownDiv.showPositionedByField(this,this.dropdownDispose.bind(this)),this.picker.focus({preventScroll:!0})}onClick(t){const e=t.target,r=e&&e.getAttribute("data-colour");null!==r&&(this.setValue(r),o.DropDownDiv.hideIfOwner(this))}onKeyDown(t){let e,r=!0;switch(t.key){case"ArrowUp":this.moveHighlightBy(0,-1);break;case"ArrowDown":this.moveHighlightBy(0,1);break;case"ArrowLeft":this.moveHighlightBy(-1,0);break;case"ArrowRight":this.moveHighlightBy(1,0);break;case"Enter":if(e=this.getHighlighted(),e){const t=e.getAttribute("data-colour");null!==t&&this.setValue(t)}o.DropDownDiv.hideWithoutAnimation();break;default:r=!1}r&&t.stopPropagation()}moveHighlightBy(t,e){if(!this.highlightedIndex)return;const r=this.colours,n=this.columns;let o=this.highlightedIndex%n,i=Math.floor(this.highlightedIndex/n);o+=t,i+=e,t<0?o<0&&i>0?(o=n-1,i--):o<0&&(o=0):t>0?o>n-1&&i<Math.floor(r.length/n)-1?(o=0,i++):o>n-1&&o--:e<0?i<0&&(i=0):e>0&&i>Math.floor(r.length/n)-1&&(i=Math.floor(r.length/n)-1);const s=this.picker.childNodes[i].childNodes[o],l=i*n+o;this.setHighlightedCell(s,l)}onMouseMove(t){const e=t.target,r=e&&Number(e.getAttribute("data-index"));null!==r&&r!==this.highlightedIndex&&this.setHighlightedCell(e,r)}onMouseEnter(){var t;null===(t=this.picker)||void 0===t||t.focus({preventScroll:!0})}onMouseLeave(){var t;null===(t=this.picker)||void 0===t||t.blur();const e=this.getHighlighted();e&&o.utils.dom.removeClass(e,"blocklyColourHighlighted")}getHighlighted(){var t;if(!this.highlightedIndex)return null;const e=this.highlightedIndex%this.columns,r=Math.floor(this.highlightedIndex/this.columns),n=null===(t=this.picker)||void 0===t?void 0:t.childNodes[r];return n?n.childNodes[e]:null}setHighlightedCell(t,e){const r=this.getHighlighted();r&&o.utils.dom.removeClass(r,"blocklyColourHighlighted"),o.utils.dom.addClass(t,"blocklyColourHighlighted"),this.highlightedIndex=e;const n=t.getAttribute("id");n&&this.picker&&o.utils.aria.setState(this.picker,o.utils.aria.State.ACTIVEDESCENDANT,n)}dropdownCreate(){const t=this.columns,e=this.colours,r=this.getValue(),n=document.createElement("table");n.className="blocklyColourTable",n.tabIndex=0,n.dir="ltr",o.utils.aria.setRole(n,o.utils.aria.Role.GRID),o.utils.aria.setState(n,o.utils.aria.State.EXPANDED,!0),o.utils.aria.setState(n,o.utils.aria.State.ROWCOUNT,Math.floor(e.length/t)),o.utils.aria.setState(n,o.utils.aria.State.COLCOUNT,t);let i=null;for(let s=0;s<e.length;s++){s%t==0&&(i=document.createElement("tr"),o.utils.aria.setRole(i,o.utils.aria.Role.ROW),n.appendChild(i));const l=document.createElement("td");i.appendChild(l),l.setAttribute("data-colour",e[s]),l.title=this.titles[s]||e[s],l.id=o.utils.idGenerator.getNextUniqueId(),l.setAttribute("data-index",`${s}`),o.utils.aria.setRole(l,o.utils.aria.Role.GRIDCELL),o.utils.aria.setState(l,o.utils.aria.State.LABEL,e[s]),o.utils.aria.setState(l,o.utils.aria.State.SELECTED,e[s]===r),l.style.backgroundColor=e[s],e[s]===r&&(l.className="blocklyColourSelected",this.highlightedIndex=s)}this.boundEvents.push(o.browserEvents.conditionalBind(n,"pointerdown",this,this.onClick,!0)),this.boundEvents.push(o.browserEvents.conditionalBind(n,"pointermove",this,this.onMouseMove,!0)),this.boundEvents.push(o.browserEvents.conditionalBind(n,"pointerenter",this,this.onMouseEnter,!0)),this.boundEvents.push(o.browserEvents.conditionalBind(n,"pointerleave",this,this.onMouseLeave,!0)),this.boundEvents.push(o.browserEvents.conditionalBind(n,"keydown",this,this.onKeyDown,!1)),this.picker=n}dropdownDispose(){for(const t of this.boundEvents)o.browserEvents.unbind(t);this.boundEvents.length=0,this.picker=null,this.highlightedIndex=null}static fromJson(t){return new this(t.colour,void 0,t)}}function s(){o.fieldRegistry.unregister("field_colour"),o.fieldRegistry.register("field_colour",i)}i.prototype.DEFAULT_VALUE="#ffffff",o.Css.register("\n.blocklyColourTable {\n  border-collapse: collapse;\n  display: block;\n  outline: none;\n  padding: 1px;\n}\n\n.blocklyColourTable>tr>td {\n  border: 0.5px solid #888;\n  box-sizing: border-box;\n  cursor: pointer;\n  display: inline-block;\n  height: 20px;\n  padding: 0;\n  width: 20px;\n}\n\n.blocklyColourTable>tr>td.blocklyColourHighlighted {\n  border-color: #eee;\n  box-shadow: 2px 2px 7px 2px rgba(0, 0, 0, 0.3);\n  position: relative;\n}\n\n.blocklyColourSelected, .blocklyColourSelected:hover {\n  border-color: #eee !important;\n  outline: 1px solid #333;\n  position: relative;\n}\n");var l=a(127),u=a(379),h=a(157),c=a(537),p=a(557);const g="colour_picker",b={type:g,message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]};function f(t,e){return[e.quote_(t.getFieldValue("COLOUR")),l.Order.ATOMIC]}function _(t,e){return[e.quote_(t.getFieldValue("COLOUR")),u.Order.ATOMIC]}function E(t,e){return[e.quote_(t.getFieldValue("COLOUR")),h.Order.ATOMIC]}function O(t,e){return[e.quote_(t.getFieldValue("COLOUR")),c.Order.ATOMIC]}function m(t,e){return[e.quote_(t.getFieldValue("COLOUR")),p.Order.ATOMIC]}const v=o.common.createBlockDefinitionsFromJsonArray([b]),C=v[g];function x(t={}){s(),o.common.defineBlocks(v),t.javascript&&(t.javascript.forBlock[g]=f),t.dart&&(t.dart.forBlock[g]=_),t.lua&&(t.lua.forBlock[g]=E),t.php&&(t.php.forBlock[g]=O),t.python&&(t.python.forBlock[g]=m)}const S="colour_random",R={type:S,message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"};function L(t,e){return[e.provideFunction_("colourRandom",`\nfunction ${e.FUNCTION_NAME_PLACEHOLDER_}() {\n  var num = Math.floor(Math.random() * 0x1000000);\n  return '#' + ('00000' + num.toString(16)).substr(-6);\n}\n`)+"()",l.Order.FUNCTION_CALL]}function T(t,e){return e.definitions_.import_dart_math="import 'dart:math' as Math;",[e.provideFunction_("colour_random",`\nString ${e.FUNCTION_NAME_PLACEHOLDER_}() {\n  String hex = '0123456789abcdef';\n  var rnd = new Math.Random();\n  return '#\${hex[rnd.nextInt(16)]}\${hex[rnd.nextInt(16)]}'\n      '\${hex[rnd.nextInt(16)]}\${hex[rnd.nextInt(16)]}'\n      '\${hex[rnd.nextInt(16)]}\${hex[rnd.nextInt(16)]}';\n}\n`)+"()",u.Order.UNARY_POSTFIX]}function N(t,e){return['string.format("#%06x", math.random(0, 2^24 - 1))',h.Order.HIGH]}function k(t,e){return[e.provideFunction_("colour_random",`\nfunction ${e.FUNCTION_NAME_PLACEHOLDER_}() {\n  return '#' . str_pad(dechex(mt_rand(0, 0xFFFFFF)), 6, '0', STR_PAD_LEFT);\n}\n`)+"()",c.Order.FUNCTION_CALL]}function I(t,e){return e.definitions_.import_random="import random",["'#%06x' % random.randint(0, 2**24 - 1)",p.Order.FUNCTION_CALL]}const y=o.common.createBlockDefinitionsFromJsonArray([R]),B=y[S];function $(t={}){s(),o.common.defineBlocks(y),t.javascript&&(t.javascript.forBlock[S]=L),t.dart&&(t.dart.forBlock[S]=T),t.lua&&(t.lua.forBlock[S]=N),t.php&&(t.php.forBlock[S]=k),t.python&&(t.python.forBlock[S]=I)}const U="colour_rgb",A={type:U,message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"};function D(t,e){const r=e.valueToCode(t,"RED",l.Order.NONE)||0,n=e.valueToCode(t,"GREEN",l.Order.NONE)||0,o=e.valueToCode(t,"BLUE",l.Order.NONE)||0;return[`${e.provideFunction_("colourRgb",`\nfunction ${e.FUNCTION_NAME_PLACEHOLDER_}(r, g, b) {\n  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;\n  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;\n  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;\n  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);\n  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);\n  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);\n  return '#' + r + g + b;\n}\n`)}(${r}, ${n}, ${o})`,l.Order.FUNCTION_CALL]}function M(t,e){const r=e.valueToCode(t,"RED",u.Order.NONE)||0,n=e.valueToCode(t,"GREEN",u.Order.NONE)||0,o=e.valueToCode(t,"BLUE",u.Order.NONE)||0;return e.definitions_.import_dart_math="import 'dart:math' as Math;",[`${e.provideFunction_("colour_rgb",`\nString ${e.FUNCTION_NAME_PLACEHOLDER_}(num r, num g, num b) {\n  num rn = (Math.max(Math.min(r, 100), 0) * 2.55).round();\n  String rs = rn.toInt().toRadixString(16);\n  rs = '0$rs';\n  rs = rs.substring(rs.length - 2);\n  num gn = (Math.max(Math.min(g, 100), 0) * 2.55).round();\n  String gs = gn.toInt().toRadixString(16);\n  gs = '0$gs';\n  gs = gs.substring(gs.length - 2);\n  num bn = (Math.max(Math.min(b, 100), 0) * 2.55).round();\n  String bs = bn.toInt().toRadixString(16);\n  bs = '0$bs';\n  bs = bs.substring(bs.length - 2);\n  return '#$rs$gs$bs';\n}\n`)}(${r}, ${n}, ${o})`,u.Order.UNARY_POSTFIX]}function H(t,e){return[`${e.provideFunction_("colour_rgb",`\nfunction ${e.FUNCTION_NAME_PLACEHOLDER_}(r, g, b)\n  r = math.floor(math.min(100, math.max(0, r)) * 2.55 + .5)\n  g = math.floor(math.min(100, math.max(0, g)) * 2.55 + .5)\n  b = math.floor(math.min(100, math.max(0, b)) * 2.55 + .5)\n  return string.format("#%02x%02x%02x", r, g, b)\nend\n`)}(${e.valueToCode(t,"RED",h.Order.NONE)||0}, ${e.valueToCode(t,"GREEN",h.Order.NONE)||0}, ${e.valueToCode(t,"BLUE",h.Order.NONE)||0})`,h.Order.HIGH]}function w(t,e){const r=e.valueToCode(t,"RED",c.Order.NONE)||0,n=e.valueToCode(t,"GREEN",c.Order.NONE)||0,o=e.valueToCode(t,"BLUE",c.Order.NONE)||0;return[`${e.provideFunction_("colour_rgb",`\nfunction ${e.FUNCTION_NAME_PLACEHOLDER_}($r, $g, $b) {\n  $r = round(max(min($r, 100), 0) * 2.55);\n  $g = round(max(min($g, 100), 0) * 2.55);\n  $b = round(max(min($b, 100), 0) * 2.55);\n  $hex = '#';\n  $hex .= str_pad(dechex($r), 2, '0', STR_PAD_LEFT);\n  $hex .= str_pad(dechex($g), 2, '0', STR_PAD_LEFT);\n  $hex .= str_pad(dechex($b), 2, '0', STR_PAD_LEFT);\n  return $hex;\n}\n`)}(${r}, ${n}, ${o})`,c.Order.FUNCTION_CALL]}function F(t,e){return[e.provideFunction_("colour_rgb",`\ndef ${e.FUNCTION_NAME_PLACEHOLDER_}(r, g, b):\n  r = round(min(100, max(0, r)) * 2.55)\n  g = round(min(100, max(0, g)) * 2.55)\n  b = round(min(100, max(0, b)) * 2.55)\n  return '#%02x%02x%02x' % (r, g, b)\n`)+"("+(e.valueToCode(t,"RED",p.Order.NONE)||0)+", "+(e.valueToCode(t,"GREEN",p.Order.NONE)||0)+", "+(e.valueToCode(t,"BLUE",p.Order.NONE)||0)+")",p.Order.FUNCTION_CALL]}const P=o.common.createBlockDefinitionsFromJsonArray([A]),G=P[U];function K(t={}){s(),o.common.defineBlocks(P),t.javascript&&(t.javascript.forBlock[U]=D),t.dart&&(t.dart.forBlock[U]=M,t.dart.addReservedWords("Math")),t.lua&&(t.lua.forBlock[U]=H),t.php&&(t.php.forBlock[U]=w),t.python&&(t.python.forBlock[U]=F)}const j="colour_blend",V={type:j,message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"};function Y(t,e){const r=e.valueToCode(t,"COLOUR1",l.Order.NONE)||"'#000000'",n=e.valueToCode(t,"COLOUR2",l.Order.NONE)||"'#000000'",o=e.valueToCode(t,"RATIO",l.Order.NONE)||.5;return[`${e.provideFunction_("colourBlend",`\nfunction ${e.FUNCTION_NAME_PLACEHOLDER_}(c1, c2, ratio) {\n  ratio = Math.max(Math.min(Number(ratio), 1), 0);\n  var r1 = parseInt(c1.substring(1, 3), 16);\n  var g1 = parseInt(c1.substring(3, 5), 16);\n  var b1 = parseInt(c1.substring(5, 7), 16);\n  var r2 = parseInt(c2.substring(1, 3), 16);\n  var g2 = parseInt(c2.substring(3, 5), 16);\n  var b2 = parseInt(c2.substring(5, 7), 16);\n  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);\n  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);\n  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);\n  r = ('0' + (r || 0).toString(16)).slice(-2);\n  g = ('0' + (g || 0).toString(16)).slice(-2);\n  b = ('0' + (b || 0).toString(16)).slice(-2);\n  return '#' + r + g + b;\n}\n`)}(${r}, ${n}, ${o})`,l.Order.FUNCTION_CALL]}function W(t,e){const r=e.valueToCode(t,"COLOUR1",u.Order.NONE)||"'#000000'",n=e.valueToCode(t,"COLOUR2",u.Order.NONE)||"'#000000'",o=e.valueToCode(t,"RATIO",u.Order.NONE)||.5;return e.definitions_.import_dart_math="import 'dart:math' as Math;",[`${e.provideFunction_("colour_blend",`\nString ${e.FUNCTION_NAME_PLACEHOLDER_}(String c1, String c2, num ratio) {\n  ratio = Math.max(Math.min(ratio, 1), 0);\n  int r1 = int.parse('0x\${c1.substring(1, 3)}');\n  int g1 = int.parse('0x\${c1.substring(3, 5)}');\n  int b1 = int.parse('0x\${c1.substring(5, 7)}');\n  int r2 = int.parse('0x\${c2.substring(1, 3)}');\n  int g2 = int.parse('0x\${c2.substring(3, 5)}');\n  int b2 = int.parse('0x\${c2.substring(5, 7)}');\n  num rn = (r1 * (1 - ratio) + r2 * ratio).round();\n  String rs = rn.toInt().toRadixString(16);\n  num gn = (g1 * (1 - ratio) + g2 * ratio).round();\n  String gs = gn.toInt().toRadixString(16);\n  num bn = (b1 * (1 - ratio) + b2 * ratio).round();\n  String bs = bn.toInt().toRadixString(16);\n  rs = '0$rs';\n  rs = rs.substring(rs.length - 2);\n  gs = '0$gs';\n  gs = gs.substring(gs.length - 2);\n  bs = '0$bs';\n  bs = bs.substring(bs.length - 2);\n  return '#$rs$gs$bs';\n}\n`)}(${r}, ${n}, ${o})`,u.Order.UNARY_POSTFIX]}function X(t,e){return[`${e.provideFunction_("colour_blend",`\nfunction ${e.FUNCTION_NAME_PLACEHOLDER_}(colour1, colour2, ratio)\n  local r1 = tonumber(string.sub(colour1, 2, 3), 16)\n  local r2 = tonumber(string.sub(colour2, 2, 3), 16)\n  local g1 = tonumber(string.sub(colour1, 4, 5), 16)\n  local g2 = tonumber(string.sub(colour2, 4, 5), 16)\n  local b1 = tonumber(string.sub(colour1, 6, 7), 16)\n  local b2 = tonumber(string.sub(colour2, 6, 7), 16)\n  local ratio = math.min(1, math.max(0, ratio))\n  local r = math.floor(r1 * (1 - ratio) + r2 * ratio + .5)\n  local g = math.floor(g1 * (1 - ratio) + g2 * ratio + .5)\n  local b = math.floor(b1 * (1 - ratio) + b2 * ratio + .5)\n  return string.format("#%02x%02x%02x", r, g, b)\nend\n`)}(${e.valueToCode(t,"COLOUR1",h.Order.NONE)||"'#000000'"}, ${e.valueToCode(t,"COLOUR2",h.Order.NONE)||"'#000000'"}, ${e.valueToCode(t,"RATIO",h.Order.NONE)||0})`,h.Order.HIGH]}function q(t,e){const r=e.valueToCode(t,"COLOUR1",c.Order.NONE)||"'#000000'",n=e.valueToCode(t,"COLOUR2",c.Order.NONE)||"'#000000'",o=e.valueToCode(t,"RATIO",c.Order.NONE)||.5;return[`${e.provideFunction_("colour_blend",`\nfunction ${e.FUNCTION_NAME_PLACEHOLDER_}($c1, $c2, $ratio) {\n  $ratio = max(min($ratio, 1), 0);\n  $r1 = hexdec(substr($c1, 1, 2));\n  $g1 = hexdec(substr($c1, 3, 2));\n  $b1 = hexdec(substr($c1, 5, 2));\n  $r2 = hexdec(substr($c2, 1, 2));\n  $g2 = hexdec(substr($c2, 3, 2));\n  $b2 = hexdec(substr($c2, 5, 2));\n  $r = round($r1 * (1 - $ratio) + $r2 * $ratio);\n  $g = round($g1 * (1 - $ratio) + $g2 * $ratio);\n  $b = round($b1 * (1 - $ratio) + $b2 * $ratio);\n  $hex = '#';\n  $hex .= str_pad(dechex($r), 2, '0', STR_PAD_LEFT);\n  $hex .= str_pad(dechex($g), 2, '0', STR_PAD_LEFT);\n  $hex .= str_pad(dechex($b), 2, '0', STR_PAD_LEFT);\n  return $hex;\n}\n`)}(${r}, ${n}, ${o})`,c.Order.FUNCTION_CALL]}function z(t,e){return[`${e.provideFunction_("colour_blend",`\ndef ${e.FUNCTION_NAME_PLACEHOLDER_}(colour1, colour2, ratio):\n  r1, r2 = int(colour1[1:3], 16), int(colour2[1:3], 16)\n  g1, g2 = int(colour1[3:5], 16), int(colour2[3:5], 16)\n  b1, b2 = int(colour1[5:7], 16), int(colour2[5:7], 16)\n  ratio = min(1, max(0, ratio))\n  r = round(r1 * (1 - ratio) + r2 * ratio)\n  g = round(g1 * (1 - ratio) + g2 * ratio)\n  b = round(b1 * (1 - ratio) + b2 * ratio)\n  return '#%02x%02x%02x' % (r, g, b)\n`)}(${e.valueToCode(t,"COLOUR1",p.Order.NONE)||"'#000000'"}, ${e.valueToCode(t,"COLOUR2",p.Order.NONE)||"'#000000'"}, ${e.valueToCode(t,"RATIO",p.Order.NONE)||0})`,p.Order.FUNCTION_CALL]}const Q=o.common.createBlockDefinitionsFromJsonArray([V]),J=Q[j];function Z(t={}){s(),o.common.defineBlocks(Q),t.javascript&&(t.javascript.forBlock[j]=Y),t.dart&&(t.dart.forBlock[j]=W,t.dart.addReservedWords("Math")),t.lua&&(t.lua.forBlock[j]=X),t.php&&(t.php.forBlock[j]=q),t.python&&(t.python.forBlock[j]=z)}function tt(t={}){x(t),K(t),$(t),Z(t)}})(),d})(),t.exports=n(r(370),r(127),r(379),r(157),r(537),r(557))},370:e=>{"use strict";e.exports=t},379:t=>{"use strict";t.exports=r},127:t=>{"use strict";t.exports=e},157:t=>{"use strict";t.exports=n},537:t=>{"use strict";t.exports=o},557:t=>{"use strict";t.exports=i}},l={};function a(t){var e=l[t];if(void 0!==e)return e.exports;var r=l[t]={exports:{}};return s[t].call(r.exports,r,r.exports,a),r.exports}a.d=(t,e)=>{for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var d={};return(()=>{"use strict";a.r(d),a.d(d,{FieldColourHsvSliders:()=>n});var t=a(370),e=a(348);class r{constructor(t=0,e=0,r=0){this.r=t,this.g=e,this.b=r}static componentToHex(t){return t<=0?"00":t>=1?"ff":("0"+(255*t+.5>>>0).toString(16)).slice(-2)}toHex(){return"#"+r.componentToHex(this.r)+r.componentToHex(this.g)+r.componentToHex(this.b)}loadFromHex(t){return this.r=parseInt(t.slice(1,3),16)/255,this.g=parseInt(t.slice(3,5),16)/255,this.b=parseInt(t.slice(5,7),16)/255,this}loadFromHsv(t){const e=6*(t.h-Math.floor(t.h));return this.r=t.v*(1-t.s*Math.max(0,Math.min(1,2-Math.abs(e-3)))),this.g=t.v*(1-t.s*Math.max(0,Math.min(1,Math.abs(e-2)-1))),this.b=t.v*(1-t.s*Math.max(0,Math.min(1,Math.abs(e-4)-1))),this}}class n extends e.FieldColour{constructor(){super(...arguments),this.valueWhenEditorWasOpened=null,this.hsvBoundEvents=[],this.hueReadout=null,this.hueSlider=null,this.saturationReadout=null,this.saturationSlider=null,this.brightnessReadout=null,this.brightnessSlider=null,this.dropdownContainer=null}showEditor_(){if(this.createDropdownSliders(),!this.dropdownContainer||!this.hueSlider)throw new Error("Failed to initialize the HSV sliders.");t.DropDownDiv.getContentDiv().appendChild(this.dropdownContainer),t.DropDownDiv.showPositionedByField(this,this.dropdownDisposeSliders.bind(this)),this.valueWhenEditorWasOpened=this.value_,this.hueSlider.focus({preventScroll:!0})}static createLabelInContainer(t,e){const r=document.createElement("div"),n=document.createElement("span"),o=document.createElement("span");return r.classList.add("fieldColourSliderLabel"),n.textContent=t,r.appendChild(n),r.appendChild(o),e.appendChild(r),o}static createSliderInContainer(t,e,r){const n=document.createElement("input");return n.classList.add("fieldColourSlider"),n.type="range",n.min=String(0),n.max=String(t),n.step=String(e),r.appendChild(n),n}createDropdownSliders(){const e=document.createElement("div");if(e.classList.add("fieldColourSliderContainer"),this.hueReadout=n.createLabelInContainer(t.Msg.HUE,e),this.hueSlider=n.createSliderInContainer(n.HUE_SLIDER_MAX,2,e),this.saturationReadout=n.createLabelInContainer(t.Msg.SATURATION,e),this.saturationSlider=n.createSliderInContainer(n.SATURATION_SLIDER_MAX,1,e),this.brightnessReadout=n.createLabelInContainer(t.Msg.BRIGHTNESS,e),this.brightnessSlider=n.createSliderInContainer(n.BRIGHTNESS_SLIDER_MAX,1,e),this.hsvBoundEvents.push(t.browserEvents.conditionalBind(this.hueSlider,"input",this,this.onSliderChange)),this.hsvBoundEvents.push(t.browserEvents.conditionalBind(this.saturationSlider,"input",this,this.onSliderChange)),this.hsvBoundEvents.push(t.browserEvents.conditionalBind(this.brightnessSlider,"input",this,this.onSliderChange)),window.EyeDropper){const r=document.createElement("button");r.classList.add("fieldColourEyedropper"),e.appendChild(document.createElement("hr")),e.appendChild(r),this.hsvBoundEvents.push(t.browserEvents.conditionalBind(r,"click",this,this.onEyedropperEvent))}this.dropdownContainer=e,this.updateSliderValues()}dropdownDisposeSliders(){for(const e of this.hsvBoundEvents)t.browserEvents.unbind(e);this.hsvBoundEvents.length=0,this.hueReadout=null,this.hueSlider=null,this.saturationReadout=null,this.saturationSlider=null,this.brightnessReadout=null,this.brightnessSlider=null,this.dropdownContainer=null,this.sourceBlock_&&t.Events.isEnabled()&&null!==this.valueWhenEditorWasOpened&&this.valueWhenEditorWasOpened!==this.value_&&(t.Events.fire(new(t.Events.get(t.Events.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened,this.value_)),this.valueWhenEditorWasOpened=null)}static hsvToHex(t,e,r){return n.helperHsv.h=t,n.helperHsv.s=e,n.helperHsv.v=r,n.helperRgb.loadFromHsv(n.helperHsv).toHex()}onSliderChange(t){if(!this.hueSlider||!this.saturationSlider||!this.brightnessSlider)throw new Error("The HSV sliders are missing.");const e=parseFloat(this.hueSlider.value)/n.HUE_SLIDER_MAX,r=parseFloat(this.saturationSlider.value)/n.SATURATION_SLIDER_MAX,o=parseFloat(this.brightnessSlider.value)/n.BRIGHTNESS_SLIDER_MAX;this.setIntermediateValue(n.hsvToHex(e,r,o)),this.renderSliders()}onEyedropperEvent(t){window.EyeDropper&&(new window.EyeDropper).open().then((t=>{this.setIntermediateValue(t.sRGBHex),this.updateSliderValues()}))}setIntermediateValue(e){const r=this.value_;this.setValue(e,!1),this.sourceBlock_&&t.Events.isEnabled()&&this.value_!==r&&t.Events.fire(new(t.Events.get(t.Events.BLOCK_FIELD_INTERMEDIATE_CHANGE))(this.sourceBlock_,this.name||null,r,this.value_))}renderSliders(){if(!(this.hueSlider&&this.hueReadout&&this.saturationSlider&&this.saturationReadout&&this.brightnessSlider&&this.brightnessReadout))throw new Error("The HSV sliders are missing.");this.hueReadout.textContent=this.hueSlider.value,this.saturationReadout.textContent=this.saturationSlider.value,this.brightnessReadout.textContent=this.brightnessSlider.value;const t=parseFloat(this.hueSlider.value)/n.HUE_SLIDER_MAX,e=parseFloat(this.saturationSlider.value)/n.SATURATION_SLIDER_MAX,r=parseFloat(this.brightnessSlider.value)/n.BRIGHTNESS_SLIDER_MAX;let o="linear-gradient(to right, ";o+=n.hsvToHex(0,e,r)+` ${n.THUMB_RADIUS}px, `,o+=n.hsvToHex(1/6,e,r)+", ",o+=n.hsvToHex(2/6,e,r)+", ",o+=n.hsvToHex(.5,e,r)+", ",o+=n.hsvToHex(4/6,e,r)+", ",o+=n.hsvToHex(5/6,e,r)+", ",o+=n.hsvToHex(1,e,r)+` calc(100% - ${n.THUMB_RADIUS}px))`,this.hueSlider.style.setProperty("--slider-track-background",o);let i="linear-gradient(to right, ";i+=n.hsvToHex(t,0,r)+` ${n.THUMB_RADIUS}px, `,i+=n.hsvToHex(t,1,r)+` calc(100% - ${n.THUMB_RADIUS}px))`,this.saturationSlider.style.setProperty("--slider-track-background",i);let s="linear-gradient(to right, ";s+=n.hsvToHex(t,e,0)+` ${n.THUMB_RADIUS}px, `,s+=n.hsvToHex(t,e,1)+` calc(100% - ${n.THUMB_RADIUS}px))`,this.brightnessSlider.style.setProperty("--slider-track-background",s)}updateSliderValues(){var t;if(!this.hueSlider||!this.saturationSlider||!this.brightnessSlider)return;const e=n.helperHsv.loadFromRgb(n.helperRgb.loadFromHex(null!==(t=this.getValue())&&void 0!==t?t:""));this.hueSlider.value=String(e.h*n.HUE_SLIDER_MAX),this.saturationSlider.value=String(e.s*n.SATURATION_SLIDER_MAX),this.brightnessSlider.value=String(e.v*n.BRIGHTNESS_SLIDER_MAX),this.renderSliders()}}n.HUE_SLIDER_MAX=360,n.SATURATION_SLIDER_MAX=100,n.BRIGHTNESS_SLIDER_MAX=100,n.THUMB_RADIUS=12,n.helperHsv=new class{constructor(t=0,e=0,r=0){this.h=t,this.s=e,this.v=r}loadFromRgb(t){const e=Math.max(Math.max(t.r,t.g),t.b),r=Math.min(Math.min(t.r,t.g),t.b);if(this.v=e,r===e)return this.h=0,this.s=0,this;const n=e-r;let o;return this.s=n/e,o=t.r===e?(t.g-t.b)/n:t.g===e?2+(t.b-t.r)/n:4+(t.r-t.g)/n,o/=6,this.h=o-Math.floor(o),this}copy(t){return this.h=t.h,this.s=t.s,this.v=t.v,this}},n.helperRgb=new r,t.fieldRegistry.register("field_colour_hsv_sliders",n),Object.defineProperty(t,"FieldColourHsvSliders",{value:n,writable:!0,enumerable:!0,configurable:!0}),t.Css.register(`\n.fieldColourSliderContainer {\n  padding: 4px;\n}\n.fieldColourSliderContainer hr {\n  border: none;\n  border-top: 1px solid #bbb;\n}\n.fieldColourSliderLabel {\n  display: flex;\n  justify-content: space-between;\n}\n.fieldColourEyedropper {\n  appearance: none;\n  position: relative;\n  border: none;\n  border-radius: 4px;\n  background: transparent;\n  font: inherit;\n  color: inherit;\n  cursor: pointer;\n  width: 100%;\n  margin: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.fieldColourEyedropper:hover {\n  background: rgba(0,0,0,0.1)\n}\n.fieldColourEyedropper input {\n  opacity: 0;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n}\n.fieldColourEyedropper::before {\n  content: "${t.Msg.EYEDROPPER}";\n}\n.fieldColourEyedropper::after {\n  content: "";\n  margin-left: 8px;\n  width: 24px;\n  height: 24px;\n  background: currentColor;\n  pointer-events: none;\n  -webkit-mask-image: var(--customize-dial-symbol);\n  -webkit-mask-repeat: no-repeat;\n  -webkit-mask-position: center;\n  mask-image: var(--customize-dial-symbol);\n  mask-repeat: no-repeat;\n  mask-position: center;\n  --customize-dial-symbol: url('data:image/svg+xml,    <svg xmlns="http://www.w3.org/2000/svg"          width="24px" height="24px"          viewBox="0 0 24 24">       <path stroke="black" strokewidth="1.414" fill="none"             d="m 13 8 L 6 15 Q 3 18 2 21 Q 0 23 .5 23.5 Q 1 24 3 22                 Q 6 21 9 18 L 16 11"/>       <path fill="black"             d="m 12 7 Q 11 6 12 5 Q 13 4 14 5 Q 15 6 16 5 Q 20 -1 22.5 1.5                 Q 25 4 19 8 Q 18 9 19 10 Q 20 11 19 12 Q 18 13 17 12"/>     </svg>');\n}\n.fieldColourSlider {\n  -webkit-appearance: none;\n  width: 150px;\n  height: 24px;\n  margin: 4px 8px 24px 8px;\n  padding: 0;\n}\n.fieldColourSlider:last-child {\n  margin-bottom: 4px;\n}\n.fieldColourSlider:focus {\n  outline: none;\n}\n/* Webkit */\n.fieldColourSlider::-webkit-slider-runnable-track {\n  background: var(--slider-track-background);\n  border-radius: 8px;\n  height: 16px;\n}\n.fieldColourSlider::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  background: #fff;\n  border-radius: 50%;\n  box-shadow: 0 0 0 4px rgba(0,0,0,.15);\n  cursor: pointer;\n  width: ${2*n.THUMB_RADIUS}px;\n  height: ${2*n.THUMB_RADIUS}px;\n  margin-top: -4px;\n}\n/* Firefox */\n.fieldColourSlider::-moz-range-track {\n  background: var(--slider-track-background);\n  border-radius: 8px;\n  height: 16px;\n}\n.fieldColourSlider::-moz-range-thumb {\n  background: #fff;\n  border: none;\n  border-radius: 50%;\n  box-shadow: 0 0 0 4px rgba(0,0,0,.15);\n  cursor: pointer;\n  width: ${2*n.THUMB_RADIUS}px;\n  height: ${2*n.THUMB_RADIUS}px;\n}\n.fieldColourSlider::-moz-focus-outer {\n  /* override the focus border style */\n  border: 0;\n}\n/* IE */\n.fieldColourSlider::-ms-track {\n  background: var(--slider-track-background);\n  border-radius: 12px;\n  width: 100%;\n  height: 24px;\n  /* remove default tick marks */\n  color: transparent;\n}\n.fieldColourSlider::-ms-fill-lower  {\n  background: transparent;\n}\n.fieldColourSlider::-ms-fill-upper  {\n  background: transparent;\n}\n.fieldColourSlider::-ms-thumb {\n  background: #fff;\n  border: none;\n  border-radius: 50%;\n  box-shadow: 0 0 0 4px rgba(0,0,0,.15);\n  cursor: pointer;\n  width: ${2*n.THUMB_RADIUS}px;\n  height: ${2*n.THUMB_RADIUS}px;\n}\n`)})(),d})()));