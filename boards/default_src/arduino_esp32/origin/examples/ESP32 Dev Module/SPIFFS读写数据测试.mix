<xml version="Mixly 2.0 rc3" board="Arduino ESP32@ESP32 Dev Module"><block type="factory_notes" id="@PHL]!*DuUG}4,6+p!6#" x="-5470" y="-1703"><field name="VALUE">SPIFFS读写数据测试</field><next><block type="factory_notes" id="OW3t@j(LMs*y{RwnFKM!"><field name="VALUE">写入文本会覆盖原数据，追加文本会在原数据后追加数据，数据添加可以选择是否换行</field></block></next></block><block type="base_setup" id="?:/FvTlD3ZGIK:wU9m[`" x="-5467" y="-1618"><statement name="DO"><block type="serial_begin" id="syZagIg,Dv1+31FCC~]q"><field name="serial_select">Serial</field><value name="CONTENT"><shadow type="math_number" id="MZIB(q8}z/1oTpLuKSH6"><field name="NUM">9600</field></shadow></value><next><block type="simple_spiffs_DelFile" id="!Li5R=}.{v)w7,7f$@OE"><value name="FileName"><shadow type="text" id="=ZPka7e(,[g-r*mzhXFx"><field name="TEXT">/fileName.txt</field></shadow></value><next><block type="simple_spiffs_store_spiffs_write" id="@ogG@no[W}@r!QI@zA(g"><field name="MODE">2</field><value name="FILE"><shadow type="text" id="Ob,.ov-7^8g@#Q4!`eXP"><field name="TEXT">/fileName.txt</field></shadow></value><value name="DATA"><shadow type="text" id="G_@*!pKPB/:-Ia69-grA"><field name="TEXT">hello world</field></shadow></value><value name="NEWLINE"><shadow type="logic_boolean" id="^Nl2X?j55m1KVX*o8!SR"><field name="BOOL">TRUE</field></shadow></value><next><block type="simple_spiffs_store_spiffs_write" id="4aZ[SKFHN944Q,Uvzq/f"><field name="MODE">2</field><value name="FILE"><shadow type="text" id="rX;tZfiY1R6hQ_?;Mj5*"><field name="TEXT">/fileName.txt</field></shadow></value><value name="DATA"><shadow type="text" id="q6r`Ra/PLRT@q?YL9:h="><field name="TEXT">hello world</field></shadow></value><value name="NEWLINE"><shadow type="logic_boolean" id="?]DHZo4=ix-X?A`HtJ:J"><field name="BOOL">TRUE</field></shadow></value><next><block type="serial_print" id="Nc@jM8.s,ju_{tu0_}`:"><field name="serial_select">Serial</field><field name="new_line">println</field><value name="CONTENT"><block type="simple_spiffs_read" id="EilhOK}z]7$@egNPERu,"><value name="FileName"><shadow type="text" id="?vDo5jJnOz|NsPg)oII4"><field name="TEXT">/fileName.txt</field></shadow></value></block></value><next><block type="simple_spiffs_DelFile" id="Q?OMyNmGD(_P#|Dg$cO#"><value name="FileName"><shadow type="text" id="{vS.Ir,^U@H5`)f[d{H."><field name="TEXT">/fileName.txt</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml><config>{"PSRAM":"disabled","PartitionScheme":"default","CPUFreq":"240","FlashMode":"qio","FlashFreq":"80","FlashSize":"4M","UploadSpeed":"921600","LoopCore":"1","EventsCore":"1"}</config><code>CiNpbmNsdWRlICJGUy5oIgojaW5jbHVkZSAiU1BJRkZTLmgiCgp2b2lkIGRlbGV0ZUZpbGUoZnM6OkZTICZmcywgY29uc3QgY2hhciAqIHBhdGgpIHsKICBpZiAoZnMucmVtb3ZlKHBhdGgpKSB7CiAgICBTZXJpYWwucHJpbnRsbigiLSBmaWxlIGRlbGV0ZWQiKTsKICB9IGVsc2UgewogICAgU2VyaWFsLnByaW50bG4oIi0gZGVsZXRlIGZhaWxlZCIpOwogIH0KfQp2b2lkIGFwcGVuZEZpbGUoZnM6OkZTICZmcywgY29uc3QgY2hhciAqIHBhdGgsIGNvbnN0IGNoYXIgKiBtZXNzYWdlKSB7CiAgRmlsZSBmaWxlID0gZnMub3BlbihwYXRoLCBGSUxFX0FQUEVORCk7CiAgaWYgKCFmaWxlKSB7CiAgICBTZXJpYWwucHJpbnRsbigiLSBmYWlsZWQgdG8gb3BlbiBmaWxlIGZvciBhcHBlbmRpbmciKTsKICAgIHJldHVybjsKICB9CiAgaWYgKGZpbGUucHJpbnQobWVzc2FnZSkpIHsKICAgIFNlcmlhbC5wcmludGxuKCItIG1lc3NhZ2UgYXBwZW5kZWQiKTsKICB9IGVsc2UgewogICAgU2VyaWFsLnByaW50bG4oIi0gYXBwZW5kIGZhaWxlZCIpOwogIH0KICBmaWxlLmNsb3NlKCk7Cn0KU3RyaW5nIHJlYWRGaWxlKGZzOjpGUyAmZnMsIGNvbnN0IGNoYXIgKiBwYXRoKSB7CiAgRmlsZSBmaWxlID0gZnMub3BlbihwYXRoKTsKICBpZiAoIWZpbGUgfHwgZmlsZS5pc0RpcmVjdG9yeSgpKSB7CiAgICBTZXJpYWwucHJpbnRsbigiLSBmYWlsZWQgdG8gb3BlbiBmaWxlIGZvciByZWFkaW5nIik7CiAgICBmaWxlLmNsb3NlKCk7CiAgICByZXR1cm4gIlNQSUZGU19lcnJvciI7CiAgfSBlbHNlIHsKICAgIFNlcmlhbC5wcmludGxuKCItIHJlYWQgZnJvbSBmaWxlOiIpOwogICAgU3RyaW5nIFNQSUZGU19kYXRhID0gIiI7CiAgICB3aGlsZSAoZmlsZS5hdmFpbGFibGUoKSkgewogICAgIFNQSUZGU19kYXRhID0gU3RyaW5nKFNQSUZGU19kYXRhKSArIFN0cmluZyhjaGFyKGZpbGUucmVhZCgpKSk7CiAgIH0KICAgZmlsZS5jbG9zZSgpOwogICByZXR1cm4gU1BJRkZTX2RhdGE7CiB9Cn0KCnZvaWQgc2V0dXAoKXsKICBTZXJpYWwuYmVnaW4oOTYwMCk7CiAgICBpZiAoIVNQSUZGUy5iZWdpbih0cnVlKSkgewogICAgU2VyaWFsLnByaW50bG4oIlNQSUZGUyBNb3VudCBGYWlsZWQiKTsKICAgcmV0dXJuOwogfQogIGRlbGV0ZUZpbGUoU1BJRkZTLCAiL2ZpbGVOYW1lLnR4dCIpOwogIGFwcGVuZEZpbGUoU1BJRkZTLCAiL2ZpbGVOYW1lLnR4dCIsIFN0cmluZyhTdHJpbmcoImhlbGxvIHdvcmxkIikgKyBTdHJpbmcoIlxyXG4iKSkuY19zdHIoKSk7CiAgYXBwZW5kRmlsZShTUElGRlMsICIvZmlsZU5hbWUudHh0IiwgU3RyaW5nKFN0cmluZygiaGVsbG8gd29ybGQiKSArIFN0cmluZygiXHJcbiIpKS5jX3N0cigpKTsKICBTZXJpYWwucHJpbnRsbihyZWFkRmlsZShTUElGRlMsICIvZmlsZU5hbWUudHh0IikpOwogIGRlbGV0ZUZpbGUoU1BJRkZTLCAiL2ZpbGVOYW1lLnR4dCIpOwp9Cgp2b2lkIGxvb3AoKXsKICAvL1NQSUZGU+ivu+WGmeaVsOaNrua1i+ivlQogIC8v5YaZ5YWl5paH5pys5Lya6KaG55uW5Y6f5pWw5o2u77yM6L+95Yqg5paH5pys5Lya5Zyo5Y6f5pWw5o2u5ZCO6L+95Yqg5pWw5o2u77yM5pWw5o2u5re75Yqg5Y+v5Lul6YCJ5oup5piv5ZCm5o2i6KGMCgp9</code>